<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Keranjang - Toko Online</title>
<style>
    * { margin:0; padding:0; box-sizing:border-box; font-family:"Poppins", sans-serif; }
    body {
        background: url('https://images.unsplash.com/photo-1505740420928-5e560c06d30e?auto=format&fit=crop&w=1500&q=80') no-repeat center center;
        background-size: cover;
        min-height:100vh;
        overflow-x:hidden;
        color:white;
    }

    nav {
        width:100%; padding:15px 30px; display:flex; justify-content:space-between; align-items:center;
        backdrop-filter: blur(10px); background: rgba(255,255,255,0.2); border-bottom:1px solid rgba(255,255,255,0.3);
        position:fixed; top:0; left:0; z-index:100;
        color:white;
    }
    nav .brand { font-size:22px; font-weight:bold; }
    nav ul { display:flex; list-style:none; gap:20px; }
    nav ul li a { color:white; text-decoration:none; padding:5px 10px; border-radius:6px; transition:.3s; }
    nav ul li a:hover { background:white; color:black; }

    main { max-width:1000px; margin:120px auto 30px; padding:0 20px; backdrop-filter: blur(6px); background: rgba(0,0,0,0.5); border-radius:12px; }

    h2 { margin-bottom:20px; color:white; }

    table { width:100%; border-collapse:collapse; background: rgba(255,255,255,0.9); color:#000; border-radius:12px; overflow:hidden; }
    th, td { padding:12px; text-align:left; border-bottom:1px solid #ccc; }
    th { background:#0077c2; color:white; }
    td img { width:80px; border-radius:8px; }
    td button { padding:6px 10px; border:none; border-radius:6px; background:#ff5722; color:white; cursor:pointer; transition:.3s; }
    td button:hover { background:#e64a19; }

    .total-row td { font-weight:bold; }

    form { margin-top:30px; background: rgba(255,255,255,0.9); color:#000; padding:20px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1); display:flex; flex-direction:column; gap:12px; }
    form input, form textarea { padding:10px; border-radius:8px; border:1px solid #ccc; width:100%; }
    form button { padding:12px; border:none; border-radius:8px; background:#0077c2; color:white; cursor:pointer; transition:.3s; font-size:16px; }
    form button:hover { background:#005a9e; }

    @media(max-width:768px){
        table, thead, tbody, th, td, tr { display:block; }
        th { display:none; }
        td { position:relative; padding-left:50%; margin-bottom:10px; border:none; }
        td::before { position:absolute; left:10px; font-weight:bold; content:attr(data-label); }
    }
</style>
</head>
<body>

<nav>
    <div class="brand">TOKO ONLINE</div>
    <ul>
        <li><a href="index.html">Beranda</a></li>
        <li><a href="produk.html">Produk</a></li>
        <li><a href="keranjang.html">Keranjang</a></li>
        <li><a href="admin-login.html">Admin</a></li>
    </ul>
</nav>

<main>
    <h2>Keranjang Belanja</h2>
    <table id="cartTable">
        <thead>
            <tr>
                <th>Nama</th>
                <th>Gambar</th>
                <th>Detail</th>
                <th>Harga</th>
                <th>Aksi</th>
            </tr>
        </thead>
        <tbody></tbody>
        <tfoot>
            <tr class="total-row">
                <td colspan="3">Total</td>
                <td id="totalHarga">Rp 0</td>
                <td></td>
            </tr>
        </tfoot>
    </table>

    <h2>Checkout</h2>
    <form id="checkoutForm">
        <input type="text" id="namaPembeli" placeholder="Nama Lengkap" required>
        <input type="text" id="alamatPembeli" placeholder="Alamat Lengkap" required>
        <input type="tel" id="noTelpPembeli" placeholder="Nomor Telepon" required>
        <button type="submit">Checkout via WhatsApp</button>
    </form>
</main>

<script>
const cartTableBody = document.getElementById("cartTable").querySelector("tbody");
const totalHargaEl = document.getElementById("totalHarga");

function loadCart() {
    const cartList = JSON.parse(localStorage.getItem("cartList")) || [];
    cartTableBody.innerHTML = "";
    let total = 0;

    cartList.forEach((item,index) => {
        const harga = Number(item.harga);
        total += harga;

        const row = document.createElement("tr");
        row.innerHTML = `
            <td data-label="Nama">${item.nama}</td>
            <td data-label="Gambar"><img src="${item.gambar}" alt="${item.nama}"></td>
            <td data-label="Detail">${item.detail}</td>
            <td data-label="Harga">Rp ${harga.toLocaleString('id-ID')}</td>
            <td data-label="Aksi"><button onclick="hapusItem(${index})">Hapus</button></td>
        `;
        cartTableBody.appendChild(row);
    });

    totalHargaEl.textContent = `Rp ${total.toLocaleString('id-ID')}`;
}

function hapusItem(index){
    const cartList = JSON.parse(localStorage.getItem("cartList")) || [];
    cartList.splice(index,1);
    localStorage.setItem("cartList", JSON.stringify(cartList));
    loadCart();
}

document.getElementById("checkoutForm").addEventListener("submit", function(e){
    e.preventDefault();
    const nama = document.getElementById("namaPembeli").value;
    const alamat = document.getElementById("alamatPembeli").value;
    const noTelp = document.getElementById("noTelpPembeli").value;
    const cartList = JSON.parse(localStorage.getItem("cartList")) || [];

    if(cartList.length === 0){
        alert("Keranjang kosong!");
        return;
    }

    let message = `Halo, saya ingin memesan produk berikut:%0A`;
    let total = 0;
    cartList.forEach((item,i)=>{
        const harga = Number(item.harga);
        total += harga;
        message += `${i+1}. ${item.nama} - ${item.detail} - Rp ${harga.toLocaleString('id-ID')}%0A`;
    });
    message += `%0ATotal: Rp ${total.toLocaleString('id-ID')}%0A`;
    message += `Nama: ${nama}%0AAlamat: ${alamat}%0ANomor Telepon: ${noTelp}`;

    const waNumber = "6285775343266";
    const waURL = `https://wa.me/${waNumber}?text=${message}`;
    window.open(waURL,"_blank");

    localStorage.removeItem("cartList");
    loadCart();
    this.reset();
});

window.addEventListener("DOMContentLoaded", loadCart);
</script>

</body>
</html>
